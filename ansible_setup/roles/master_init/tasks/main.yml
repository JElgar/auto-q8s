- name: INITIALISE
  shell: "kubeadm init --pod-network-cidr=192.168.0.0/16 --control-plane-endpoint={{ control_plane_endpoint }}"

- name: Copy Conf
  fetch:
    src: /etc/kubernetes/admin.conf
    dest: ~/.kube/config
    flat: yes

- name: Create join command
  shell: kubeadm token create --print-join-command
  register: join_command

- name: Export join command to a 'host-fact' type variable
  set_fact:
    join_command: "{{ join_command }}"
